# MyTask セットアップマニュアル

## 概要
MyTask は Google Apps Script と Google Sheets を使用した軽量タスク管理アプリケーションです。

---

## 1. スプレッドシートの準備

### 1-1. フォルダの作成（推奨）
Google Drive に「MyTask」などの専用フォルダを作成し、スプレッドシートやGASプロジェクトをまとめて管理することをお勧めします。

### 1-2. 新規スプレッドシートの作成
作成したフォルダ内で、Google Sheets の新しいスプレッドシートを作成します。

### 1-3. MasterData シートの設定
- デフォルトで作成される「シート1」の名前を `MasterData` に変更します。
- このシートはアクセス権限を管理します。
- A列に、アプリケーションへのアクセスを許可するメールアドレスを入力してください。
  ```
  例: A1: user@example.com
      A2: another@example.com
  ```

> **注**: TaskData シートは、アプリ初回起動時に自動的に作成されます。手動で作成する必要はありません。

### 1-4. スプレッドシートIDの取得
作成したスプレッドシートのURLを開き、以下の部分をコピーします。
```
https://docs.google.com/spreadsheets/d/【この部分がID】/edit
```

---

## 2. Google Apps Script プロジェクトの作成

### 2-1. GASプロジェクトを作成
1. 手順1で作成したDriveフォルダを開く
2. フォルダ内で右クリック →「その他」→「Google Apps Script」を選択
3. 新しいタブでGASエディタが開きます
4. プロジェクト名を「MyTask」などに変更（左上の「無題のプロジェクト」をクリック）

### 2-2. ファイルのアップロード

配布された以下の3つのファイルを GAS エディタに登録します。

**① Code.gs**
1. GASエディタで「コード.gs」ファイルを開く
2. 配布された `Code.gs` の内容を**全て**コピーして貼り付け
3. ファイル内の以下の行を探し、先ほどコピーしたスプレッドシートIDに書き換えます。
   ```javascript
   SPREADSHEET_ID: 'ここにスプレッドシートIDを貼り付け',
   ```

**② index.html**
1. GASエディタで「ファイル」→「HTML」→「HTMLファイルを作成」を選択
2. ファイル名を `index` にする
3. 配布された `index.html` の内容を**全て**コピーして貼り付け

**③ appsscript.json**
1. GASエディタの左サイドバー「プロジェクトの設定（歯車アイコン）」を開く
2. 「「appsscript.json」マニフェスト ファイルをエディタで表示する」にチェックを入れる
3. エディタに戻り、表示された `appsscript.json` を開く
4. 配布された `appsscript.json` の内容を**全て**コピーして貼り付け

### 2-3. 保存
すべてのファイルを保存します（Ctrl+S または ⌘+S）。

---

## 3. デプロイ

### 3-1. 新しいデプロイの作成
1. GASエディタ右上の「デプロイ」→「新しいデプロイ」をクリック
2. 「種類の選択」で「ウェブアプリ」を選択
3. 以下のように設定：
   - **説明**: 任意（例: 初回デプロイ）
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: 全員（または組織内のユーザー）
4. 「デプロイ」をクリック

### 3-2. 権限の承認
初回デプロイ時、権限の承認が求められます。
1. 「アクセスを承認」をクリック
2. Google アカウントを選択
3. 「詳細」→「（プロジェクト名）に移動」をクリック
4. 「許可」をクリック

### 3-3. URLの取得
デプロイが完了すると、ウェブアプリのURLが表示されます。このURLをブックマークしてください。

---

## 4. 使い方

### 基本操作
- **タスクの追加**: 右上の「新規タスク追加」ボタンをクリック
- **タスクの編集**: カードをクリックして編集
- **タスクの移動**: カードをドラッグ＆ドロップで別の列に移動
- **タスクの完了**: カード右側のチェックアイコンをクリック
- **完了の取り消し**: 完了列のカードのチェックアイコンをクリック

### その他の機能
- **フィルタ**: ヘッダー左側でグループや優先度による絞り込み
- **ソート**: 各列のヘッダーで並び替え（デフォルト/優先度/グループ/期限）
- **列幅の調整**: 列と列の境界線をドラッグして幅を変更
- **完了列の表示切替**: 右上の「完了: 表示/非表示」ボタン
- **詳細表示切替**: 右上の「詳細表示/詳細非表示」ボタン
- **Google Task 抽出**: Google カレンダーのタスクをインポート
- **ラベル**: カード左側の★アイコンをクリックして変更

### 期限の表示
- 通常の期限: 濃いグレーで表示
- **期限切れ**: 赤字で太字表示（完了済みタスクを除く）

---

## トラブルシューティング

### アクセスできない
- MasterData シートに自分のメールアドレスが登録されているか確認してください

### タスクが表示されない
- スプレッドシートIDが正しく設定されているか確認してください
- TaskData シートが存在するか確認してください

### Google Task 抽出が動作しない
- `appsscript.json` が正しく設定されているか確認してください
- 初回実行時は権限の承認が必要です

---

## サポート
問題が解決しない場合は、管理者にお問い合わせください。
